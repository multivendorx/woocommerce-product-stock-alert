jQuery(document).ready(function(e){var t;function a(e){return!!/^[\w\-\.\+]+\@[a-zA-Z0-9\.\-]+\.[a-zA-z0-9]{2,4}$/.test(e)}function r(t){return e.trim(t)}e(".variations_form").on("woocommerce_variation_select_change",function(){e(".alert_container").css("display","none")}),e(window).bind("found_variation",function(i,l){var s=e(".current_product_id").val();if(null==l)e("#product-"+s).is(".outofstock")||e("#product-"+s).is(".onbackorder")?e(".alert_container").css("display","block"):e(".alert_container").css("display","none");else{var n="";n=l.hasOwnProperty("variation_id")?l.variation_id:l.id,e(".alert_container").css("display","none");var c,o={action:"alert_box_ajax",child_id:n};e.post(woo_stock_alert_script_data.ajax_url,o,function(t){"true"==t?e(".alert_container").css("display","block"):"false"==t&&e(".alert_container").css("display","none")}),c=n,e(".alert_container").off("click").on("click",".stock_alert_button",function(){if(cus_email=e(this).parent().find(".stock_alert_email").val(),pro_id=e(this).parent().find(".current_product_id").val(),pro_title=e(this).parent().find(".current_product_name").val(),t=e(".alert_container").html(),alert_text_html=woo_stock_alert_script_data.alert_text_html,button_html=woo_stock_alert_script_data.button_html,alert_success=woo_stock_alert_script_data.alert_success,alert_email_exist=woo_stock_alert_script_data.alert_email_exist,valid_email=woo_stock_alert_script_data.valid_email,unsubscribe_button_html=woo_stock_alert_script_data.unsubscribe_button,alert_success=(alert_success=alert_success.replace("%product_title%",pro_title)).replace("%customer_email%",cus_email),alert_email_exist=(alert_email_exist=alert_email_exist.replace("%product_title%",pro_title)).replace("%customer_email%",cus_email),cus_email&&a(cus_email)){e(this).attr("value",woo_stock_alert_script_data.processing),e(this).addClass("stk_disabled");for(var i={action:"alert_ajax",email:cus_email,product_id:c},l=0;l<woo_stock_alert_script_data.additional_fields.length;l++)i[woo_stock_alert_script_data.additional_fields[l]]=e(this).parent().find("."+woo_stock_alert_script_data.additional_fields[l]).val();e.post(woo_stock_alert_script_data.ajax_url,i,function(t){console.log(t),e(this).removeClass("stk_disabled"),"0"==t?e(".alert_container").html('<div class="registered_message">'+woo_stock_alert_script_data.error_occurs+'<a href="'+window.location+'"> '+woo_stock_alert_script_data.try_again+"</a></div>"):"/*?%already_registered%?*/"==r(t)?e(".alert_container").html('<div class="registered_message">'+alert_email_exist+"</div>"+unsubscribe_button_html+'<input type="hidden" class="subscribed_email" value="'+cus_email+'" /><input type="hidden" class="product_id" value="'+c+'" />'):e(".alert_container").html('<div class="registered_message">'+alert_success+"</div>")})}else e(".alert_container").html(alert_text_html+'<input type="text" class="stock_alert_email" name="alert_email" />'+button_html+'<p style="color:#e2401c;" class="stock_alert_error_message">'+valid_email+'</p><input type="hidden" class="current_product_id" value="'+pro_id+'" /><input type="hidden" class="current_product_name" value="'+pro_title+'" />')})}}).trigger("found_variation"),e(".alert_container").off("click").on("click",".stock_alert_button",function(){var t=e(this);if(cus_email=e(this).parent().find(".stock_alert_email").val(),pro_id=e(this).parent().find(".current_product_id").val(),pro_title=e(this).parent().find(".current_product_name").val(),register_box=e(".alert_container").html(),alert_text_html=woo_stock_alert_script_data.alert_text_html,button_html=woo_stock_alert_script_data.button_html,alert_success=woo_stock_alert_script_data.alert_success,alert_email_exist=woo_stock_alert_script_data.alert_email_exist,valid_email=woo_stock_alert_script_data.valid_email,unsubscribe_button_html=woo_stock_alert_script_data.unsubscribe_button,alert_success=(alert_success=alert_success.replace("%product_title%",pro_title)).replace("%customer_email%",cus_email),alert_email_exist=(alert_email_exist=alert_email_exist.replace("%product_title%",pro_title)).replace("%customer_email%",cus_email),cus_email&&a(cus_email)){e(this).toggleClass("alert_loader").blur();for(var i={action:"alert_ajax",email:cus_email,product_id:pro_id},l=0;l<woo_stock_alert_script_data.additional_fields.length;l++)i[woo_stock_alert_script_data.additional_fields[l]]=e(this).parent().find("."+woo_stock_alert_script_data.additional_fields[l]).val();e.post(woo_stock_alert_script_data.ajax_url,i,function(a){console.log(a),t.removeClass("alert_loader").blur(),"0"==a?e(".alert_container").html('<div class="registered_message">'+woo_stock_alert_script_data.error_occurs+'<a href="'+window.location+'"> '+woo_stock_alert_script_data.try_again+"</a></div>"):"/*?%already_registered%?*/"==r(a)?e(".alert_container").html('<div class="registered_message">'+alert_email_exist+"</div>"+unsubscribe_button_html+'<input type="hidden" class="subscribed_email" value="'+cus_email+'" /><input type="hidden" class="product_id" value="'+pro_id+'" />'):e(".alert_container").html('<div class="registered_message">'+alert_success+"</div>")})}else e(".alert_container").html(alert_text_html+'<input type="text" class="stock_alert_email" name="alert_email" />'+button_html+'<p style="color:#e2401c;" class="stock_alert_error_message">'+valid_email+'</p><input type="hidden" class="current_product_id" value="'+pro_id+'" /><input type="hidden" class="current_product_name" value="'+pro_title+'" />')}),e(document).on("click",".alert_container .unsubscribe_button",function(){e(this).text(woo_stock_alert_script_data.processing),e(this).addClass("stk_disabled");var t={action:"unsubscribe_button",customer_email:e(this).parent().find(".subscribed_email").val(),product_id:e(this).parent().find(".product_id").val()};unsubscribe_successful_messsage=(unsubscribe_successful_messsage=woo_stock_alert_script_data.alert_unsubscribe_message).replace("%customer_email%",t.customer_email),e.post(woo_stock_alert_script_data.ajax_url,t,function(t){e(this).removeClass("stk_disabled"),"true"==r(t)?e(".alert_container").html('<div class="registered_message">'+unsubscribe_successful_messsage+"</div>"):e(".alert_container").html('<div class="registered_message">'+woo_stock_alert_script_data.error_occurs+'<a href="'+window.location+'"> '+woo_stock_alert_script_data.try_again+"</a></div>")})})});